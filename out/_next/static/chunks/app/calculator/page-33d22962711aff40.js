(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[179],{8456:(e,t,i)=>{var n={"./2002":[8062,833],"./2002.ts":[8062,833]};function r(e){if(!i.o(n,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=n[e],r=t[0];return i.e(t[1]).then(()=>i(r))}r.keys=()=>Object.keys(n),r.id=8456,e.exports=r},8528:(e,t,i)=>{Promise.resolve().then(i.bind(i,8737))},8737:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>$});var n=i(7437),r=i(2265);let s=e=>(0,n.jsx)(n.Fragment,{children:e.children});var a=i(7818),l=i(3073),o=i.n(l),c=i(5984),d=i(4792),u=i(2960),h=i(5510),p=i(6548);let m=e=>{let t=(0,u.Z)();return(0,n.jsx)(h.Z,{variant:"progress",steps:e.totalSteps,position:"static",activeStep:e.activeStep,nextButton:(0,n.jsxs)(p.Z,{size:"small",onClick:e.handleNext,disabled:e.activeStep>=e.totalSteps-1,children:["PR\xd3XIMO","rtl"===t.direction?(0,n.jsx)(c.Z,{}):(0,n.jsx)(d.Z,{})]}),backButton:(0,n.jsxs)(p.Z,{size:"small",onClick:e.handleBack,disabled:0===e.activeStep,children:["rtl"===t.direction?(0,n.jsx)(d.Z,{}):(0,n.jsx)(c.Z,{}),"VOLTAR"]})})};var x=i(903);let g=[2002],v=[],j=async(e,t)=>{let n=async()=>(await Promise.all(g.map(async t=>{let n=await i(8456)("./".concat(t)),r=e.getInput(t),s=n.default(r,e);s&&v.push({id:t.toString(),message:s})})),t(v),v.length>0);if(v.length=0,!e||1===e.nextStep)return!1;let r=e.form.Groups[e.nextStep-2];return r.Fields.forEach(t=>{var i;let n=null===(i=e.inputGroups[r.ID])||void 0===i?void 0:i.inputs[t.ID];t.Required&&!n&&v.push({id:t.ID.toString(),message:t.Name+" \xe9 um campo obrigat\xf3rio"}),(t.Required||n&&n.value)&&((n&&t.CustomValue&&!t.Values.some(e=>e===n.value)||!t.Values.length)&&t.Units.length>0&&n&&(!n.unit||"empty"===n.unit)&&v.push({id:"".concat(t.ID,"_un"),message:"Campo obrigat\xf3rio"}),(0===t.Values.length||n&&t.Values.length>0&&t.CustomValue&&!t.Values.some(e=>e===n.value))&&n&&t.Regex&&!new RegExp(t.Regex).test(n.value)&&v.push({id:t.ID.toString(),message:"Campo ".concat(t.Name," inv\xe1lido")}))}),console.log("errors ",v),await n()},Z={nextStep:0,form:{ID:"",Groups:[]},setForm:e=>{console.log(e)},inputGroups:{},setInputGroups:e=>{console.log(e)},getData:()=>({}),setInput:(e,t)=>{console.log(e+t.value)},getInput:e=>{console.log(e)},setNextStep:e=>{console.log(e)},hasErrors:()=>Promise.resolve(!1),errors:[]},f=(0,x.U)((e,t)=>({...Z,setForm:t=>e(e=>({...e,form:t})),setNextStep:t=>e(e=>({...e,nextStep:t})),setInputGroups:t=>e(e=>({...e,inputGroups:Object.fromEntries(t.map(e=>[e.id,e]))})),getData:()=>({ID:t().form.ID,Groups:Object.values(t().inputGroups).map(e=>({ID:e.id,Values:Object.values(e.inputs).map(e=>({ID:e.id,Value:e.value,Unit:e.unit})).filter(e=>!!e.Value)}))}),errors:[],hasErrors:()=>j(t(),t=>e(e=>({...e,errors:t}))),getInput:e=>{let i=[];return Object.values(t().inputGroups).forEach(e=>i.push(...Object.values(e.inputs))),i.find(t=>t.id===e)||{id:e,value:"",unit:""}},setInput:(i,n)=>{let{id:r,value:s,unit:a}=n;return e(e=>{let n=t().getInput(r);if(!n)return e;let l={id:r,value:s,unit:a||n.unit},o=e.inputGroups[i]||{id:i,inputs:{}},c=Object.values(o.inputs).length>0?{...o.inputs,[r]:l}:{[r]:l};return{...e,inputGroups:{...e.inputGroups,[i]:{...o,inputs:c}}}})}}));var I=i(8472);let D=async e=>(await (0,I.Z)({method:"get",url:"https://calc.ghg-impact.eu/form.php?id=".concat(e)})).data,b=async e=>{console.log((await (0,I.Z)({method:"post",url:"https://calc.ghg-impact.eu/calc.php",data:e})).data)};var y=i(9869),C=i(6858),S=i(2434),w=i(8644),z=i(6065),F=i(9217),N=i(5870),U=i(437),E=i(6223),k=i(335),O=i(9621),G=i(511),V=i(8165),R=i(7913),M=i(3657);let _=e=>{let t=JSON.stringify(e),i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),i.setAttribute("download","calculadora.json"),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)},q=async e=>{var t;if(!(null===(t=e.target.files)||void 0===t?void 0:t.length))return{};let i=e.target.files[0];return"application/json"!=i.type?{errorMessage:"Ficheiro inv\xe1lido"}:{data:await new Response(i).json()}};var P=i(152);let W=(0,y.Z)({components:{MuiInputLabel:{styleOverrides:{root:{backgroundColor:"white",padding:"0 10px 0 10px"}}}}}),B=e=>{let{group:t}=e,{setInput:i,getInput:s,errors:a,inputGroups:l}=f(e=>e),[o,c]=(0,r.useState)(t.Fields),[d,u]=(0,r.useState)([]),h=(e,n)=>{1===e.Units.length?i(t.ID,{id:e.ID,value:n,unit:e.Units[0].Unit}):i(t.ID,{id:e.ID,value:n})},m=e=>{let i=t.Fields.find(t=>t.ID===e);c(o.filter(t=>t.ID!==e)),u([...d,i])},x=e=>{u(d.filter(t=>t.ID!==e.ID)),c([...o,e])},g=(e,r)=>{var s;if(0===e.Units.length)return;let l=e.MultiField?3:4;return 1===e.Units.length?(0,n.jsx)(C.Z,{label:"Unidade",value:e.Units[0].Unit,disabled:!0}):(0,n.jsx)(S.Z,{size:{xs:l,md:l},children:(0,n.jsxs)(w.Z,{error:a.some(t=>t.id==="".concat(e.ID,"_un")),required:e.Required,fullWidth:!0,children:[(0,n.jsx)(z.Z,{id:"combo-unit-".concat(e.ID),children:"Unidade"}),(0,n.jsxs)(F.Z,{labelId:"combo-unit-".concat(e.ID),id:"combo-unit-".concat(e.ID,"-label"),value:r.unit,onChange:n=>i(t.ID,{id:e.ID,value:r.value,unit:n.target.value}),fullWidth:!0,children:[(0,n.jsx)(N.Z,{value:"empty",children:"\xa0"},""),e.Units.map(e=>(0,n.jsx)(N.Z,{value:e.Unit,children:e.Unit},e.Unit))]}),(0,n.jsx)(U.Z,{children:null===(s=a.find(t=>t.id==="".concat(e.ID,"_un")))||void 0===s?void 0:s.message})]})})},v=e=>{var t;let i=s(e.ID);if(!i)return(0,n.jsx)(n.Fragment,{});let r=e.Units.length>0?8:12;return(0,n.jsxs)(S.Z,{size:{xs:12,md:12},container:!0,spacing:1,children:[(0,n.jsx)(S.Z,{size:{xs:r,md:r},children:(0,n.jsx)(E.Z,{title:e.Desc,arrow:!0,children:(0,n.jsx)(C.Z,{fullWidth:!0,label:e.Name,required:e.Required,onChange:t=>h(e,t.target.value),error:a.some(t=>t.id===e.ID.toString()),helperText:null===(t=a.find(t=>t.id===e.ID.toString()))||void 0===t?void 0:t.message,value:i.value})})}),e.Units.length>0?(0,n.jsxs)(n.Fragment,{children:[g(e,i),e.MultiField?(0,n.jsx)(S.Z,{size:{xs:1,md:1},alignContent:"center",children:(0,n.jsx)(k.Z,{"aria-label":"delete",onClick:()=>x(e),title:"Remover",children:(0,n.jsx)(M.Z,{})})}):void 0]}):void 0]})},j=e=>{var r;let l=s(e.ID);if(!l)return(0,n.jsx)(n.Fragment,{});let o=e.Values.map(e=>(0,n.jsx)(N.Z,{value:e,children:e},e));if(e.CustomValue){let e=(0,n.jsx)(N.Z,{value:"other",children:"Outro"},"other");o.push(e)}return(0,n.jsxs)(w.Z,{sx:{minWidth:"50%"},error:a.some(t=>t.id===e.ID.toString()),required:e.Required,children:[(0,n.jsx)(z.Z,{id:"combo-".concat(e.ID),children:e.Name}),(0,n.jsx)(E.Z,{title:e.Desc,arrow:!0,children:(0,n.jsx)(F.Z,{labelId:"combo-".concat(e.ID),id:"combo-".concat(e.ID,"-label"),value:l.value,onChange:n=>i(t.ID,{id:e.ID,value:n.target.value}),fullWidth:!0,children:o})}),(0,n.jsx)(U.Z,{children:null===(r=a.find(t=>t.id===e.ID.toString()))||void 0===r?void 0:r.message})]})},Z=e=>{let t=s(e.ID);if(!t)return(0,n.jsx)(n.Fragment,{});let i=t.value,r=!!i&&e.CustomValue&&("other"===i||!e.Values.some(e=>e===i));return e.Values&&e.Values.length&&!r?j(e):v(e)};return(0,n.jsxs)(O.Z,{theme:W,children:[(0,n.jsxs)(S.Z,{container:!0,children:[(0,n.jsx)(S.Z,{size:{xs:10,md:10},children:(0,n.jsx)(G.Z,{variant:"h5",component:"h5",style:{margin:"20px 0 20px 0"},children:t.Name})}),(0,n.jsx)(S.Z,{alignContent:"center",children:(0,n.jsx)(E.Z,{title:"Exportar dados preenchidos para continuar mais tarde",arrow:!0,children:(0,n.jsx)(p.Z,{variant:"outlined",onClick:()=>_(l),endIcon:(0,n.jsx)(P.Z,{}),children:"Exportar"})})})]}),(0,n.jsxs)(S.Z,{container:!0,children:[t.Desc?(0,n.jsx)(S.Z,{size:{xs:12,md:12},sx:{margin:"10px 0 20px 0"},children:(0,n.jsx)(V.Z,{icon:(0,n.jsx)(R.Z,{fontSize:"inherit"}),severity:"warning",children:t.Desc})}):void 0,t.Fields.some(e=>e.MultiField)?(0,n.jsxs)(n.Fragment,{children:[d.map(e=>(0,n.jsx)(S.Z,{size:{xs:12,md:12},sx:{minHeight:"85px"},children:Z(e)},e.ID)),(()=>{let e=[],i=new Set(o.filter(e=>!!e.MultiFieldGroup).map(e=>e.MultiFieldGroup));i.size?Array.from(i).map(e=>({name:e,items:o.filter(t=>t.MultiFieldGroup===e)})).forEach(t=>{e.push((0,n.jsx)(N.Z,{style:{backgroundColor:"#e1dbda"},value:t.name,children:t.name},t.name)),e.push(...t.items.map(e=>(0,n.jsx)(N.Z,{value:e.ID,children:e.Name},e.ID)))}):e=o.map(e=>(0,n.jsx)(N.Z,{value:e.ID,children:e.Name},e.ID));let r=e=>{Array.from(i).some(t=>t===e)||m(Number(e))};return(0,n.jsxs)(w.Z,{fullWidth:!0,children:[(0,n.jsx)(z.Z,{id:"combo-multifield-".concat(t.Name),children:"Escolha ..."}),(0,n.jsx)(F.Z,{labelId:"combo-multifield-".concat(t.Name),id:"combo-multifield-".concat(t.Name,"-label"),value:"",onChange:e=>r(e.target.value),fullWidth:!0,children:e})]})})()]}):t.Fields.map(e=>(0,n.jsx)(S.Z,{size:{xs:12,md:12},sx:{minHeight:"85px"},children:Z(e)},e.ID))]})]})};var A=i(2197),H=i(2856);let L=()=>{let{getData:e}=f(e=>e);return(0,n.jsxs)(S.Z,{container:!0,spacing:2,style:{height:"780px"},children:[(0,n.jsxs)(S.Z,{size:{xs:12,md:12},container:!0,alignContent:"center",justifyContent:"center",flexDirection:"column",style:{textAlign:"center"},children:[(0,n.jsx)(G.Z,{gutterBottom:!0,variant:"h5",component:"div",children:"Preenchimento conclu\xeddo"}),(0,n.jsx)(G.Z,{variant:"body2",sx:{color:"text.secondary"},children:"Iremos agora efectuar os c\xe1lculos e gerar os resultados."})]}),(0,n.jsx)(S.Z,{size:{xs:12,md:12},container:!0,justifyContent:"center",alignContent:"flex-start",children:(0,n.jsx)(p.Z,{variant:"contained",endIcon:(0,n.jsx)(H.Z,{}),onClick:()=>{b(e())},size:"large",children:"Calcular"})})]})};var T=i(374),J=i(1573),Q=i(2433);let X=(0,i(8024).ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),K=e=>{let{onBegin:t}=e,{setInputGroups:i}=f(e=>e),[s,a]=r.useState({show:!1}),l=async e=>{let t=await q(e);if(t.errorMessage){a({show:!0,message:t.errorMessage,severity:"error"});return}if(!t.data){a({show:!0,message:"Erro na leitura do ficheiro",severity:"error"});return}i(Object.values(t.data)),a({show:!0,message:"Ficheiro importado com sucesso!"})};return(0,n.jsxs)(S.Z,{container:!0,spacing:2,style:{height:"780px"},children:[(0,n.jsxs)(S.Z,{size:{xs:12,md:12},container:!0,alignContent:"center",justifyContent:"center",children:[(0,n.jsx)(G.Z,{gutterBottom:!0,variant:"h5",component:"div",children:"Calculadora de pegada de carbono"}),(0,n.jsx)(G.Z,{variant:"body2",sx:{color:"text.secondary"},children:"Este c\xe1lculo – confidencial e sem custos para os participantes – \xe9 orientado pelo INEGI e pelo SerQ e ir\xe1 mostrar quais s\xe3o as principais amea\xe7as e oportunidades de melhoria do setor e onde \xe9 mais produtivo atuar, com vista \xe0 descarboniza\xe7\xe3o."})]}),(0,n.jsxs)(S.Z,{size:{xs:12,md:12},container:!0,justifyContent:"center",alignContent:"flex-start",children:[(0,n.jsx)(E.Z,{title:"Iniciar o preenchimento dos dados para a calculadora",arrow:!0,children:(0,n.jsx)(p.Z,{variant:"contained",endIcon:(0,n.jsx)(J.Z,{}),onClick:()=>{t()},size:"large",children:"Iniciar"})}),(0,n.jsx)(E.Z,{title:"Importar dados de uma calculadora previamente preenchida",arrow:!0,children:(0,n.jsxs)(p.Z,{variant:"outlined",endIcon:(0,n.jsx)(Q.Z,{}),size:"large",component:"label",children:["Importar",(0,n.jsx)(X,{type:"file",onChange:e=>l(e)})]})})]}),(0,n.jsx)(T.Z,{open:s.show,autoHideDuration:6e3,onClose:()=>a({show:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,n.jsx)(V.Z,{onClose:()=>a({show:!1}),severity:s.severity||"success",variant:"filled",sx:{width:"100%"},children:s.message})})]})},Y=()=>{let[e,t]=r.useState({initialStep:0,nextStep:()=>{},previousStep:()=>{}}),[i,a]=r.useState(0),{setNextStep:l,setForm:c,form:d,hasErrors:u}=f(e=>e),h=async()=>{let t=i+1;l(t),await u()||(a(t),e.nextStep())},p=(0,r.useCallback)(async()=>{c(await D("anipc"))},[c]);(0,r.useEffect)(()=>{p()},[p]);let x=()=>d?d.Groups.map(e=>(0,n.jsx)(s,{children:(0,n.jsx)(B,{group:e})},e.ID)):[],g=()=>[(0,n.jsx)(K,{onBegin:h},"initialStep"),...x(),(0,n.jsx)(L,{},"finalStep")];return d?(0,n.jsx)(A.Z,{maxWidth:"md",children:(0,n.jsxs)(S.Z,{container:!0,children:[(0,n.jsx)(S.Z,{size:{xs:12,md:12},sx:{minHeight:"780px"},children:(0,n.jsx)(o(),{instance:i=>t({...e,...i}),children:g()})}),(0,n.jsx)(S.Z,{size:{xs:12,md:12},children:(0,n.jsx)(m,{activeStep:i,handleBack:()=>{let t=i-1;l(t),a(t),e.previousStep()},handleNext:h,totalSteps:g().length})})]})}):(0,n.jsx)(n.Fragment,{children:"loading"})},$=(0,a.default)(()=>Promise.resolve(Y),{ssr:!1})}},e=>{var t=t=>e(e.s=t);e.O(0,[486,130,215,744],()=>t(8528)),_N_E=e.O()}]);